---
title: "3. Executing Functions"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Cmd+Shift+Enter*. 

Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Cmd+Option+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Cmd+Shift+K* to preview the HTML file).

### Data lists

#### NetCDF data lists
```{r}
def_dl <- list.files(paste0(raw_dirc, "def"), pattern = "nc",
                      recursive = TRUE, full.names = TRUE)
ffwi_dl <- list.files(paste0(raw_dirc, "ffwi"), pattern = "nc",
                       recursive = TRUE, full.names = TRUE)
```

### Import NetCDF, process, Export as GTiff
```{r}
UseCores <- detectCores() -1
cl       <- makeCluster(UseCores)

ffwi_95 <- foreach(i = 1:length(ffwi_dl)) %dopar% {
  netcdf_to_tif_numabove95(ffwi_dl[i], usa_shp, "NumDaysAbove95th")}

ffwi_mean <-   foreach(i = 1:length(ffwi_dl)) %dopar% {
  netcdf_day_to_tif_month(ffwi_dl[i], usa_shp, "MonthlyMean")}

def_mean <- foreach(i = 1:length(ffwi_dl)) %dopar% {
  netcdf_month_to_tif_month(def_dl[i], usa_shp, "MonthlyMean")}

stopCluster(cl)
```

